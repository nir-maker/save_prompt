<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שמירת פרומפט לקובץ Word</title>
    <style>
        /* הסגנונות שלך */
    </style>
    <!-- הוספת ספריית docx מה-CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.4.0/docx.min.js" integrity="sha512-TsGkR0IjN2wClb5pz3EZZc8K3E1GhMH+FvG1KjB6xOQGZl8IWejFPKAp1YkFjlDx4Hp0cQy1M6r8IuWnO70g+Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="container">
        <h1>שמירת פרומפט לקובץ Word</h1>
        <textarea id="promptInput" placeholder="הכנס כאן את הפרומפט..."></textarea>
        <button id="saveButton">שמור כקובץ Word</button>
    </div>

    <script>
        document.getElementById('saveButton').addEventListener('click', async () => {
            const prompt = document.getElementById('promptInput').value.trim();

            if (!prompt) {
                alert('אנא הזן תוכן לפני השמירה!');
                return;
            }

            // יצירת מסמך Word באמצעות docx
            const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType } = docx;

            // יצירת פסקה עם כותרת
            const title = new Paragraph({
                text: "פרומפט שנשמר",
                heading: HeadingLevel.HEADING_1,
                alignment: AlignmentType.RIGHT,
            });

            // יצירת פסקה עם תוכן
            const content = new Paragraph({
                children: [
                    new TextRun({
                        text: prompt,
                        font: "Arial",
                        size: 24, // 12pt
                        bidi: true, // כיוון ימין לשמאל
                    }),
                    new TextRun({
                        break: 1
                    })
                ],
                alignment: AlignmentType.RIGHT,
            });

            // יצירת המסמך
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [title, content],
                }],
            });

            try {
                // הפיכת המסמך ל-blob
                const blob = await Packer.toBlob(doc);

                // יצירת URL להורדה
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "prompt.docx";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error("שגיאה בעת יצירת המסמך:", error);
                alert("אירעה שגיאה בעת יצירת קובץ ה-Word. נא לבדוק את הקונסול למידע נוסף.");
            }
        });
    </script>
</body>
</html>
